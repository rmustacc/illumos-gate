.\"
.\" This file and its contents are supplied under the terms of the
.\" Common Development and Distribution License ("CDDL"), version 1.0.
.\" You may only use this file in accordance with the terms of version
.\" 1.0 of the CDDL.
.\"
.\" A full copy of the text of the CDDL should have accompanied this
.\" source.  A copy of the CDDL is also available via the Internet at
.\" http://www.illumos.org/license/CDDL.
.\"
.\"
.\" Copyright 2015 Joyent, Inc.
.\"
.Dd June 20, 2015
.Dt PR_CREAT 3PROC
.Os
.Sh NAME
.Nm pr_exit
.Nd inject exit system call into victim process
.Sh SYNOPSIS
.Lb libproc
.In libproc.h
.Ft int
.Fo pr_exit
.Fa "struct ps_prochandle *P"
.Fa "int status"
.Fc
.Sh DESCRIPTION
The
.Fn pr_exit
function injects the
.Xr exit 2
system call into the target process specified by the process handle
.Fa P
by means of the agent lwp.
If the process handle
.Fa P
is the value
.Dv NULL
then this will be equivalent to calling
.Xr exit 2
on the currently running process.
.Pp
The argument
.Fa status
has the same meaning as in
.Xr exit 2 ,
see
.Xr exit 2
for the full description and purpose of the
.Sy exit
system call and its arguments.
.Pp
The
.Fn pr_exit
function only works on active processes. Process handles that correspond
to core files, zombie processes, or ELF objects do not support system
call injection.
.Sh RETURN VALUES
Upon successful completion, the
.Fn pr_exit
function's return value is that described in
.Xr exit 2 .
Otherwise,
.Sy -1
is returned and
.Sy errno
is set to
.Er ENOSYS
to indicate that the system call could not be injected.
.Pp
If the
.Fn pr_exit
function is called with the value of
.Fa P
set to
.Dv NULL ,
then the function will not return.
.Sh ERRORS
For a full list of possible errors see the
.Sy ERRORS
section in
.Xr exit 2 .
.Pp
The
.Fn pr_exit
function will fail if:
.Bl -tag -width Er
.It Er ENOSYS
An error occurred while trying to invoke the agent lwp and inject a
system call in the process handle
.Fa P
or the process handle
.Fa P
does not support system call injection.
.El
.Sh INTERFACE STABILITY
.Sy Committed
.Sh MT-LEVEL
See
.Sy LOCKING
in
.Xr libproc 3LIB .
.Sh SEE ALSO
.Xr exit 2 ,
.Xr libproc 3LIB ,
.Xr proc 4
